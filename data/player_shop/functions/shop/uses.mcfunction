#####################################################################################
# Update Shop:
# 1. Remove the Items
# 2. Reset Slot
# 3. Reset scoreboard
#####################################################################################
execute if score @s ps_slot_0 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:11b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:18b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:19b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:20b}]} run data remove block ~ ~-1 ~ Items[{Slot:20b}]
execute if score @s ps_slot_0 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:11b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:18b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:19b}]} run data remove block ~ ~-1 ~ Items[{Slot:19b}]
execute if score @s ps_slot_0 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:11b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:18b}]} run data remove block ~ ~-1 ~ Items[{Slot:18b}]
execute if score @s ps_slot_0 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:11b}]} run data remove block ~ ~-1 ~ Items[{Slot:11b}]
execute if score @s ps_slot_0 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} run data remove block ~ ~-1 ~ Items[{Slot:10b}]
execute if score @s ps_slot_0 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} run data remove block ~ ~-1 ~ Items[{Slot:9b}]
execute if score @s ps_slot_0 matches 1.. run data remove block ~ ~-1 ~ Items[{Slot:2b}]
execute if score @s ps_slot_0 matches 1.. run data modify entity @s Offers.Recipes[0].uses set value 0
execute if score @s ps_slot_0 matches 1.. run scoreboard players set @s ps_slot_0 0


execute if score @s ps_slot_1 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:14b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:21b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:22b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:23b}]} run data remove block ~ ~-1 ~ Items[{Slot:23b}]
execute if score @s ps_slot_1 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:14b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:21b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:22b}]} run data remove block ~ ~-1 ~ Items[{Slot:22b}]
execute if score @s ps_slot_1 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:14b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:21b}]} run data remove block ~ ~-1 ~ Items[{Slot:21b}]
execute if score @s ps_slot_1 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:14b}]} run data remove block ~ ~-1 ~ Items[{Slot:14b}]
execute if score @s ps_slot_1 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} run data remove block ~ ~-1 ~ Items[{Slot:13b}]
execute if score @s ps_slot_1 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} run data remove block ~ ~-1 ~ Items[{Slot:12b}]
execute if score @s ps_slot_1 matches 1.. run data remove block ~ ~-1 ~ Items[{Slot:5b}]
execute if score @s ps_slot_1 matches 1.. run data modify entity @s Offers.Recipes[1].uses set value 0
execute if score @s ps_slot_1 matches 1.. run scoreboard players set @s ps_slot_1 0


execute if score @s ps_slot_2 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:17b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:24b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:25b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:26b}]} run data remove block ~ ~-1 ~ Items[{Slot:26b}]
execute if score @s ps_slot_2 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:17b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:24b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:25b}]} run data remove block ~ ~-1 ~ Items[{Slot:25b}]
execute if score @s ps_slot_2 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:17b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:24b}]} run data remove block ~ ~-1 ~ Items[{Slot:24b}]
execute if score @s ps_slot_2 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:17b}]} run data remove block ~ ~-1 ~ Items[{Slot:17b}]
execute if score @s ps_slot_2 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} run data remove block ~ ~-1 ~ Items[{Slot:16b}]
execute if score @s ps_slot_2 matches 1.. unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} run data remove block ~ ~-1 ~ Items[{Slot:15b}]
execute if score @s ps_slot_2 matches 1.. run data remove block ~ ~-1 ~ Items[{Slot:8b}]
execute if score @s ps_slot_2 matches 1.. run data modify entity @s Offers.Recipes[2].uses set value 0
execute if score @s ps_slot_2 matches 1.. run scoreboard players set @s ps_slot_2 0



#####################################################################################
# Automaticly update when player has traded:
#####################################################################################
execute store result score @s ps_slot_0 run data get entity @s Offers.Recipes[0].uses
execute store result score @s ps_slot_1 run data get entity @s Offers.Recipes[1].uses
execute store result score @s ps_slot_2 run data get entity @s Offers.Recipes[2].uses


#####################################################################################
# Trade Successful place items in secondary chest:
#####################################################################################
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_0=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:11b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:18b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:19b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:20b}]} run data modify block ~ ~-2 ~ Items[{Slot:18b}] merge from entity @s HandItems.[0].tag.ps_inventory[0]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_0=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:11b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:18b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:19b}]} run data modify block ~ ~-2 ~ Items[{Slot:11b}] merge from entity @s HandItems.[0].tag.ps_inventory[0]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_0=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:11b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:18b}]} run data modify block ~ ~-2 ~ Items[{Slot:10b}] merge from entity @s HandItems.[0].tag.ps_inventory[0]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_0=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:11b}]} run data modify block ~ ~-2 ~ Items[{Slot:9b}] merge from entity @s HandItems.[0].tag.ps_inventory[0]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_0=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:10b}]} run data modify block ~ ~-2 ~ Items[{Slot:2b}] merge from entity @s HandItems.[0].tag.ps_inventory[0]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_0=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:9b}]} run data modify block ~ ~-2 ~ Items[{Slot:1b}] merge from entity @s HandItems.[0].tag.ps_inventory[0]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_0=1..}] if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:2b}]} run data modify block ~ ~-2 ~ Items[{Slot:0b}] merge from entity @s HandItems.[0].tag.ps_inventory[0]


execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_1=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:14b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:21b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:22b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:23b}]} run data modify block ~ ~-2 ~ Items[{Slot:21b}] merge from entity @s HandItems.[0].tag.ps_inventory[1]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_1=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:14b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:21b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:22b}]} run data modify block ~ ~-2 ~ Items[{Slot:14b}] merge from entity @s HandItems.[0].tag.ps_inventory[1]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_1=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:14b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:21b}]} run data modify block ~ ~-2 ~ Items[{Slot:13b}] merge from entity @s HandItems.[0].tag.ps_inventory[1]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_1=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:14b}]} run data modify block ~ ~-2 ~ Items[{Slot:12b}] merge from entity @s HandItems.[0].tag.ps_inventory[1]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_1=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:13b}]} run data modify block ~ ~-2 ~ Items[{Slot:5b}] merge from entity @s HandItems.[0].tag.ps_inventory[1]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_1=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:12b}]} run data modify block ~ ~-2 ~ Items[{Slot:4b}] merge from entity @s HandItems.[0].tag.ps_inventory[1]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_1=1..}] if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:5b}]} run data modify block ~ ~-2 ~ Items[{Slot:3b}] merge from entity @s HandItems.[0].tag.ps_inventory[1]


execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_2=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:17b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:24b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:25b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:26b}]} run data modify block ~ ~-2 ~ Items[{Slot:24b}] merge from entity @s HandItems.[0].tag.ps_inventory[2]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_2=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:17b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:24b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:25b}]} run data modify block ~ ~-2 ~ Items[{Slot:17b}] merge from entity @s HandItems.[0].tag.ps_inventory[2]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_2=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:17b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:24b}]} run data modify block ~ ~-2 ~ Items[{Slot:16b}] merge from entity @s HandItems.[0].tag.ps_inventory[2]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_2=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:17b}]} run data modify block ~ ~-2 ~ Items[{Slot:15b}] merge from entity @s HandItems.[0].tag.ps_inventory[2]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_2=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:16b}]} run data modify block ~ ~-2 ~ Items[{Slot:8b}] merge from entity @s HandItems.[0].tag.ps_inventory[2]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_2=1..}] unless block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:15b}]} run data modify block ~ ~-2 ~ Items[{Slot:7b}] merge from entity @s HandItems.[0].tag.ps_inventory[2]
execute as @a at @s[scores={ps_trade_success=1..}] run execute as @e[type=minecraft:villager,tag=player_shop,distance=0..5] at @s[scores={ps_slot_2=1..}] if block ~ ~-1 ~ minecraft:chest{Items:[{Slot:8b}]} run data modify block ~ ~-2 ~ Items[{Slot:6b}] merge from entity @s HandItems.[0].tag.ps_inventory[2]
